const lyrics = ["Alright,\nnow listen, baby\n\nYou don't care for me\nI don'-a care about that\nGotta new fool, ha!\nI like it like that\n\nI have only one burning desire\nLet me stand next to your fire\nLet me stand next to your fire [Repeat 4 times]\n\nListen here, baby\nand stop acting so crazy\nYou say your mum ain't home,\nit ain't my concern,\nJust play with me and you won't get burned\n\nI have only one itching desire\nLet me stand next to your fire\nLet me stand next to your fire [Repeat 4 times]\n\nOh! Move over, Rover\nand let Jimi take over\nYeah, you know what I'm talking 'bout\nYeah, get on with it, baby\nThat's what I'm talking 'bout\nNow dig this!\nHa!\nNow listen, baby\n\nYou try to gimme your money\nyou better save it, babe\nSave it for your rainy day\n\nI have only one burning desire\nLet me stand next to your fire\nLet me stand next to your fire",
  "[Intro:]\nI think it's bout' time that we hit these n***as upside\nthe head with some of that west coast\ngangsta' sh......... Ooh.....Wee!!!!!!!!!!\n\n[1st Verse:]\nIt's a whole 'nother day\nI'm back up in ya'\nSnoop D-O-Double G\nI representa'\nBeen away for a while but you all know\nI'm still doggystylin' on Death Row\nGot shit locked down\nSewed up\nSo If you plan on comin' out nigga hold up.\nThis a stick up\ndick up\nThey got yo' shit on the shelf, oh mine is too\nand guess who they gon' pick up?\nSome niggas think they know they shit\nBut they don't\nSome M-A's escape\nSome won't\nBumpin' heads with niggas\nWhere you from?\nEast Side Long Beach, nigga, 2-1\nThe homie just got paroled\nAnd he got more stories than the highway patrol\nTellin' me about the money Suge Knight stole\nBut I'll make that shit late\nCause nigga I get swole\nNiggas tryin' to get in, to get out.\nPut me up on game tellin' me who gon' jack me\nBut ever since\nI was a puppy\ntill I was paroled\nI never had no other dog pullin' on my chrome.\n\n[Chorus:]\nSay Snoop's upside yo' head,\nsay Snoop's upside yo' head. [4x]\n\n[2nd Verse:]\nNiggas in the game be doin' way too much\nAkin' tough with this east-west coast stuff.\nSee Me\nI'm all about my money mane\nI stay fly and dry\nI don't get caught up in the rain\nCuz game recognize game\nNo matter where you from\nWe all can get dumb, insane and\nturn the party out\nwithout a doubt\nUnless\nyou them niggas who ain't got no clout\nLBC and B what?\nUh, my crew\nCuz uh, we out there smokin' on the krazy glue\nUpside yo' head like oops\nSnoop's\nThe shit, that you hear them bumpin' in the hoops.\nCan't afford it\nhomeboy\nThis is finished\nI represented\nFrom V-A to Venice\nSo when it's timid\nAnd cold outside\nRely on the Doggy Dogg\nTo put the heat in yo' life\n\n[Chorus]\n\n[3rd Verse:]\nIt takes a whole lot\nto be number one\nI can't walk down the street\nwithout my gun\nI can't trust these niggas fool\nIt ain't no fun\nI'm sittin' up in court\nCuz somebody got dumped\nWhat really counts is how the crowd bounce\nGo home and say\nSnoop rocked the parte`\nNobody got kilt\nIt's what got annouced\nI guess they got a chance to see Dr. Bombay\nBut I keep my heat in case niggas get cold\nWarm you up with the sheet\nZip you up and roll\nNow Doggystyle records is now official\nGettin' money at the Pliz-ate with my initials\nShippin' weapons overseas\nI'm makin' G's\nWhat who you make call enemies\nBut I\nSee nothing funny about\nmakin' money\nCuz uh\nWe all know it don't grow on trees\nSo I\nGotta' get what I gotta' get when I can\nUp homie in the mo'ning wit' the gat van\nBurning rubber down to get a new car\nSo don't get jealous when you see me in the\ndouble R.\n\n[Chorus (3x)]",
  "I can't remember anything\nCan't tell if this is true or dream\nDeep down inside I feel the scream\nThis terrible silence stops me\n\nNow that the war is through with me\nI'm waking up, I cannot see\nThat there's not much left of me\nNothing is real but pain now\n\nHold my breath as I wish for death\nOh please, God, wake me\n\nBack in the womb it's much too real\nIn pumps life that I must feel\nBut can't look forward to reveal\nLook to the time when I'll live\n\nFed through the tube that sticks in me\nJust like a wartime novelty\nTied to machines that make me be\nCut this life off from me\n\nHold my breath as I wish for death\nOh please, God, wake me\n\nNow the world is gone, I'm just one\nOh God, help me\nHold my breath as I wish for death\nOh please, God, help me\n\nDarkness\nImprisoning me\nAll that I see\nAbsolute horror\nI cannot live\nI cannot die\nTrapped in myself\nBody my holding cell\n\nLandmine\nHas taken my sight\nTaken my speech\nTaken my hearing\nTaken my arms\nTaken my legs\nTaken my soul\nLeft me with life in hell",
  // "[Verse 1:]\nLoving him is like driving a new Maserati down a dead-end street\nFaster than the wind, passionate as sin, ending so suddenly\nLoving him is like trying to change your mind once you're already flying through the free fall\nLike the colors in autumn, so bright just before they lose it all\n\n[Chorus:]\nLosing him was blue like I'd never known\nMissing him was dark grey all alone\nForgetting him was like trying to know somebody you never met\nBut loving him was red\nLoving him was red\n\n[Verse 2:]\nTouching him was like realizing all you ever wanted was right there in front of you\nMemorizing him was as easy as knowing all the words to your old favorite song\nFighting with him was like trying to solve a crossword and realizing there's no right answer\nRegretting him was like wishing you never found out that love could be that strong\n\n[Chorus:]\nLosing him was blue like I'd never known\nMissing him was dark grey all alone\nForgetting him was like trying to know somebody you never met\nBut loving him was red\nOh, red\nBurning red\n\n[Bridge:]\nRemembering him comes in flashbacks and echoes\nTell myself it's time now, gotta let go\nBut moving on from him is impossible\nWhen I still see it all in my head\nIn burning red\nBurning, it was red\n\n[Chorus:]\nOh, losing him was blue like I'd never known\nMissing him was dark grey all alone\nForgetting him was like trying to know somebody you never met\n'Cause loving him was red\nYeah, yeah, red\nWe're burning red\n\n[Post-Chorus:]\nAnd that's why he's spinnin' 'round in my head\nComes back to me, burning red\nYeah, yeah\n\nHis love was like driving a new Maserati down a dead-end street ",
]

const images = ["jimi.jpeg", "snoop_dog.jpg", "metallica.jpg", "taylor_swift.jpeg", "jumbo_image.jpg"];
const index = Math.floor(Math.random() * lyrics.length);

document.getElementById('lyrics').innerHTML = lyrics[index];
document.getElementById('jumboimage').setAttribute("style", `background-image:url('${images[index]}');`)

let last_idx = ""
const baseURL = 'http://127.0.0.1:8000/'

function updateGenre(g) {
  // console.log(`updating to ${g}`)
  document.getElementById("thanks").innerHTML = `Updating to ${g}...`;
  document.getElementById("thanks").style.visibility = "visible";
  if (last_idx !== '') {
    url = `http://127.0.0.1:8000/update/${last_idx}/${g}`;
    // @app.get("/update/{idx}/{truth}")

    var xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.onload = function () {
      responseObj = JSON.parse(this.response)
      console.log(responseObj)
      // the response is not a real JSON object, but a string
      status = responseObj["message"]
      document.getElementById("thanks").innerHTML = `<br><p>Thank you for improving the model!</p><p>You can now close this window</p>`;

      last_idx = ""

    };
    xhr.send();
  }
}

function submitTheForm() {
  document.getElementById("check").style.visibility = "hidden";
  document.getElementById("thanks").style.visibility = "hidden";
  document.getElementById("prediction").innerHTML = `Calculating....`

  let lyric = document.getElementById('lyrics').value

  // Replace \n (does not work with regex)
  let text = ""
  for (let l of lyric) {
    if (l.charCodeAt(0) == 10) {
      text += " "
    } else {
      text += l
    }
  }

  let url = `${baseURL}predict/${text}`;

  // AJAX
  var xhr = new XMLHttpRequest();
  xhr.open('GET', url, true);
  xhr.onload = function () {
    let responseObj = JSON.parse(this.response)
    console.log(responseObj)
    // the response is not a real JSON object, but a string
    let genre = responseObj["message"]
    last_idx = responseObj["id"]

    document.getElementById("prediction").innerHTML = `Predicted genre: ${genre}`
    document.getElementById("check").style.visibility = "visible";

  };
  xhr.send();



  // Return true to proceed
  return true;
}